# 모델링 
```{r, include = FALSE} 
library(dplyr)
library(ggplot2)
library(lubridate)
library(stringr)
library(data.table)
library(kableExtra)
library(plotly)
library(dlookr)
dir <- 'C:/Users/JDW/Desktop/PROJECT/PRODUCEX/CRAWLING DATA/2020ver'
boylist <- readLines('C:/Users/JDW/Desktop/PROJECT/PRODUCEX/final_boylist.txt')
boylist2 <- str_sub(boylist, -2, -1)
```
&nbsp;방송이 끝난 2019년으로부터 지금은 1년이란 시간이 넘게 흘렀습니다. 그동안 "프로듀스 X 101" 조작 논란에 대한 재판이 진행이 되었었고, 재판 결과에 따른 새로운 사실도 드러났었습니다. 처음 이 글을 마친 2019년 연말에는 단순히 언급량을 집계하여 과거의 언급된 량을 순위처럼 취급하고 글을 끝 마쳤었는데, 1년이 지난 지금 새로운 방식으로 순위를 집계 해 보고자 합니다. 더불어 재판과 관련된 이슈또한 짚어보고 글을 마쳐보는것으로 하겠습니다.   

## 파일 불러오기 & 구조 확인 
&nbsp;지난번에 전처리까지 끝마쳤던 데이터를 불러와 구조를 확인해 보도록 하겠습니다.   
```{r, message=FALSE, warning=FALSE}
library(dplyr)
library(stringr)
library(dlookr)

pxdata <- readRDS(str_glue('{dir}/pxdata.rds'))
pxdata %>% head()
pxdata %>% summary()
pxdata %>% glimpse()
pxdata %>% dlookr::diagnose()
```
&nbsp;분석에 대상이 되는 데이터는 총 11개의 변수와 1542120행으로 이루어진 것을 확인 할 수 있습니다. 데이터 수집 당시 획득한 변수로는 게시물의 제목을 의미하는 `p_title`과 게시물에 있는 댓글의 갯수를 의미하는 `p_comment_num`, 게시물의 작성시간인 `p_time`, 게시물의 조회수를 의미하는 `p_count`, 그리고 게시물 추천수의 갯수인 `p_recommend` 변수가 있는데요. 오늘은 이들 변수를 활용하여 예측 모델링을 수행해보는 과정을 알아보겠습니다.    

## 예측 방식 설정 
&nbsp;이전에 했던 작업들을 되짚어보면 단순히 연습생의 언급량 즉, 온라인 게시판에서 게시물 제목에 등장하는 연습생의 이름을 세어보는 형식으로 순위를 매겨 보았었습니다. 시청자들의 인기투표로 선발되는 프로그램이니 만큼 시청자들의 입으로부터 많이 회자가 되면 그만큼 인기가 있을 것이란 가정하에 진행한 방식이였는데요. 오늘은 이를 확장하여 분석 모델링을 수행하겠습니다. 먼저 모델링을 통해 알고자 하는 바가 무엇인지를 정하는 것이 우선이겠습니다. 각 연습생의 인기가 게시물에서의 등장 횟수로 반영된다고 가정하였으므로 종속변수로 언급량(`mention`)을 설정하겠습니다.   

&nbsp;일간을 기준으로 그룹핑하여 각 연습생별 언급량 및 댓글수, 조회수, 추천수를 `total`이란 변수에 저장하겠습니다. 
```{r, cache=TRUE, message=FALSE, warning=FALSE}
temp <- c()
total <- c()
for(i in seq(1, length(boylist2))){
    # print(i)
    temp <- pxdata %>%
        filter(str_detect(p_title, boylist2[i])) %>%
        group_by(p_ymd) %>%
        summarise(sum_mention   = n(),
                  sum_comment   = sum(p_comment_num, na.rm = T),
                  sum_count     = sum(p_count),
                  sum_recommend = sum(p_recommend)) %>%
        mutate(boy = boylist[i])

    total <- rbind(total, temp)
}

total %>% glimpse()
DT::datatable(total)
```


































































